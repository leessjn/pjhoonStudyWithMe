<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Study Time Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        #video { max-width: 100%; }
    </style>
</head>
<body>
    <h1>Study Time Tracker</h1>
    
    <div>
        <input type="text" id="username" placeholder="Enter your name">
        <button id="start-btn">Start Studying</button>
        <button id="stop-btn" disabled>Stop Studying</button>
    </div>

    <video id="video" autoplay></video>

    <div id="rankings">
        <h2>Study Time Rankings</h2>
        <table id="rankings-table">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Username</th>
                    <th>Total Study Time</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        const video = document.getElementById('video');
        const usernameInput = document.getElementById('username');
        const startBtn = document.getElementById('start-btn');
        const stopBtn = document.getElementById('stop-btn');
        const rankingsTable = document.querySelector('#rankings-table tbody');

        video.src = '/video_feed';

        startBtn.onclick = async () => {
            const username = usernameInput.value || 'Anonymous';
            const response = await fetch('/start_study', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username })
            });
            startBtn.disabled = true;
            stopBtn.disabled = false;
        };

        stopBtn.onclick = async () => {
            const response = await fetch('/stop_study', { method: 'POST' });
            const data = await response.json();
            
            rankingsTable.innerHTML = data.rankings.map((rank, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${rank.name}</td>
                    <td>${rank.total_study_time} seconds</td>
                </tr>
            `).join('');

            startBtn.disabled = false;
            stopBtn.disabled = true;
        };
    </script>
</body>
</html>
